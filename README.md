# گزارش فیلترینگ اینترنت ایران (دی ۱۴۰۴)

سلام من اینجا از وضعیتی که تو این مدت قطعی داشتیم (شاید دوباره قطعی داشته باشیم) می‌نویسم و تمامی راهکارهایی که تست کردم رو آموزش و محتواهاشو همینجا می‌ذارم که اگر دوباره رفتیم تو فیلترینگ بتونید آماده باشید یا حداقل همه راهکارها رو داشته باشید که اگر هرکدوم جواب نداد جایگزین کنید و خودتونو برای شرایط خیلی بدتر آماده کنید.

اولین پست رو با همین ساختار جلو می‌برم تا بعداً آپدیتش کنم هرچی بود.

---

## قدم اول: چطوری ارتباط خودمون رو در شرایط فیلترینگ شدید هنگام اتصال SSH پایدار نگه داریم؟

اگر این پیام رو دیدی:

client_loop: send disconnect: Broken pipe

یعنی یه مشکلی بین ارتباط تو و مسیر شبکه‌ای که هست اتفاقی افتاده که احتمالاً توسط DPI شناسایی شده یا فیلترینگ یا هرچیزی که کانکشنت رو می‌بنده.

نکته مهم: این مال زمانیه که تو حتی به ۳ ثانیه هم نمی‌رسه و سریع بسته می‌شه و تو عملاً خیلی کار زیادی حتی نمی‌تونی stunnel رو نصب کنی و بخوای کاور کنی.

راهکارهایی که می‌تونی بررسیشون کنی رو به ترتیب می‌گم که شاید به کمکت بیاد:

---

### تغییر پورت پیش‌فرض SSH

اولین کار بیا پورت دیفالت SSH که ۲۲ هست رو تغییر بده و یکم اوضاع رو بهتر کن (قطعاً خیلی فرق نمی‌کنه ولی حداقل یکم شرایط بهبود پیدا می‌کنه) و بذارش مثلاً روی ۴۴۳ یا هرچیزی که می‌خوای، فقط حواست باشه پورته جایی تداخل نداشته باشه تو سرور.

خوب مگه نمی‌گی بیشتر از ۳ ثانیه نمی‌شه کانکت شد، چطوری من پورت رو تغییر بدم؟

اینجا به قدرت SSH می‌رسیم.

شما به راحتی می‌تونی کامند اجرا کنی و تغییر موردنظرت رو بدی با کامند:

```bash
ssh user@SERVER_IP "sudo sed -i 's/#Port 22/Port 443/' /etc/ssh/sshd_config && sudo systemctl restart ssh"
```
که جای user نام کاربری خودت که معمولاً بهتره با root ران کنی و آی‌پی سرور خودت جایگزین کنی و همون‌طور که می‌بینی خیلی واضح مشخصه که کامندلاین چیکار می‌کنه.

روش‌هایی که تست کردم

در قدم دوم ما اینجا روش‌هایی که تا جایی که دانش قد می‌ده برات می‌نویسم و اگر روش دیگه‌ای حتماً داشتی آخر همینجا راه ارتباطی می‌ذارم و بهم پیام بده.

### روش stunnel:

اینه که SSH رو داخل TLS بپیچی و ببری بیرون یعنی کل ترافیک SSH مثل ترافیک HTTPS دیده می‌شه. این روش برای جاهایی که SSH بلاک شده ولی HTTPS بازه خیلی کاربردیه.

مزیتش اینه که ساده‌ست، روی TCP کار می‌کنه و تقریباً همه‌جا جواب می‌ده.
ضعفش اینه که اگر DPI خیلی پیشرفته باشه، ممکنه باز هم شناسایی بشه.

نکته: این روش تست شد و در زمان فیلترینگ دی ۱۴۰۴ با شکست مواجه شد

### روش WebSocket

این هم مشابه قبلی هستش یعنی می‌ره سمت HTTPS با این تفاوت که از پروکسی و CDN مثل کلادفلر می‌شه ردش کرد. نکته‌اش اینه که شما می‌تونی cloudflared رو نصب کنی هم روی سرور هم روی کلاینت و پیاده‌سازیش کنی که اون هم آموزش نصبش رو می‌ذارم.


### روش VPN

این روش دقیقاً مثل اینه که SSH رو ببری داخل تونل VPN و می‌تونی وصل بشی. از ابزارهایی مثل SoftEther یا WireGuard یا OpenConnect می‌تونی استفاده کنی.

### روش‌های obfuscation و Shadowsocks یا obfs4 یا v2ray

این روش‌ها رو من سه‌تای اولیش رو تست کردم و سعی می‌کنم آموزشش رو هم بذارم که بتونید در شرایط بشدت سخت و فیلترینگ حداقل اتصال پایدار برقرار کنید.

نکته: این روش تست شد و در زمان فیلترینگ دی ۱۴۰۴ با شکست مواجه شد.

### روش dnstt

روش dnstt که باید ترکیب کنی با چند تا پروتکل دیگه برای وصل شدن، تنها روشی بود که حداقل یک ارتباط بشدت سخت و کندی رو برقرار می‌کرد. سعی می‌کنم در مورد روش پیاده‌سازیش و ترکیب کردنش با SSH و اینکه اصلاً چطوری می‌شه کامل هم سمت کلاینت هم سمت سرور پیاده‌سازیش کرد رو آموزش دقیق بذارم و یه داکیومنت کامل بنویسم در موردش.

ممنونم که تا اینجا اومدی

Tr1t0n

راه ارتباطی تلگرام:

@Tr1tons